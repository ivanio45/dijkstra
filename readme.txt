я использвал правую ассоциативность.(3^3^4=3^(3^4))
но так и не смог реализовать считывание выражния с консоли:(
код страшный, но работает:)